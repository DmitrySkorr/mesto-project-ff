(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{GX:()=>z,Ml:()=>H,AO:()=>T,fW:()=>V,q_:()=>C,zA:()=>O});const t=(e,t,o)=>{const n=e.querySelector(`.${t.id}-error`);t.classList.remove(o.inputErrorClass),n.classList.remove(o.errorClass),n.textContent=""},o=(e,o)=>{o.validity.patternMismatch?o.setCustomValidity(o.dataset.errorMessage):o.setCustomValidity(""),o.validity.valid?t(e,o,a):((e,t,o,n)=>{const r=e.querySelector(`.${t.id}-error`);t.classList.add(n.inputErrorClass),r.textContent=o,r.classList.add(n.errorClass)})(e,o,o.validationMessage,a)};function n(e,t){!function(e){return e.some((e=>!e.validity.valid))}(e)?(t.disabled=!1,t.classList.remove(a.inactiveButtonClass)):(t.disabled=!0,t.classList.add(a.inactiveButtonClass))}function r(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{t.addEventListener("submit",(function(e){e.preventDefault()})),((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),c=e.querySelector(t.submitButtonSelector);n(r,c),r.forEach((t=>{t.addEventListener("input",(function(){o(e,t),n(r,c)}))}))})(t,e)}))}function c(e,o){const n=Array.from(e.querySelectorAll(o.inputSelector)),r=e.querySelector(o.submitButtonSelector);n.forEach((n=>{t(e,n,o)})),r.classList.add(o.inactiveButtonClass)}const a={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function i(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",u)}function s(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",u)}function u(e){"Escape"===e.key&&s(document.querySelector(".popup_is-opened"))}function l(e){e.querySelector(".popup__close").addEventListener("click",(function(){s(e)})),e.addEventListener("click",(function(t){t.target===e&&s(e)}))}const p=document.querySelector("#card-template").content,d=document.querySelector(".popup_type_delete-card"),_=d.querySelector(".popup__button");function f(e,t,o,n,r,c,a,i){const s=p.querySelector(".card").cloneNode(!0),u=s.querySelector(".card__delete-button"),l=s.querySelector(".card__like-button");let d=s.querySelector(".card__like-button-counter");return d.textContent=o.length,document.querySelector(".card__image"),s.querySelector(".card__image").alt=e,s.querySelector(".card__image").src=t,o.forEach((function(e){e._id===H&&l.classList.add("card__like-button_is-active")})),s.querySelector(".card__title").textContent=e,l.addEventListener("click",(e=>a(e,o,d,n))),y(r,H,u,n),s.querySelector(".card__image").addEventListener("click",(e=>i(e))),s}function m(e,t,o,n){e.target.classList.contains("card__like-button_is-active")?(e.target.classList.remove("card__like-button_is-active"),function(e,t){fetch(`https://nomoreparties.co/v1/wff-cohort-5/cards/likes/${e}`,{method:"DELETE",headers:{authorization:"c52618b5-5707-4e7f-96f5-da48c2905442","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(e.status))).then((e=>{t.textContent=e.likes.length})).catch((e=>{console.log(e)}))}(n,o)):(e.target.classList.add("card__like-button_is-active"),function(e,t){fetch(`https://nomoreparties.co/v1/wff-cohort-5/cards/likes/${e}`,{method:"PUT",headers:{authorization:"c52618b5-5707-4e7f-96f5-da48c2905442","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(e.status))).then((e=>{t.textContent=e.likes.length})).catch((e=>{console.log(e)}))}(n,o))}function y(e,t,o,n){e==t?o.addEventListener("click",(function(e){const t=e;i(d),l(d),_.addEventListener("click",(()=>{(function(e){e.target.closest(".places__item").remove()})(t),s(d),function(e){fetch(`https://nomoreparties.co/v1/wff-cohort-5/cards/${e}`,{method:"DELETE",headers:{authorization:"c52618b5-5707-4e7f-96f5-da48c2905442","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Ошибка: ${e.status}`))).catch((e=>{console.log(e)}))}(n)}))})):o.style.display="none"}Promise.all([fetch("https://nomoreparties.co/v1/wff-cohort-5/users/me",{headers:{authorization:"c52618b5-5707-4e7f-96f5-da48c2905442"}}).then((e=>e.ok?e.json():Promise.reject(e.status))),fetch("https://nomoreparties.co/v1/wff-cohort-5/cards",{headers:{authorization:"c52618b5-5707-4e7f-96f5-da48c2905442"}}).then((e=>e.ok?e.json():Promise.reject(e.status))).catch((e=>{console.log(e)}))]).then((([e,t])=>{T.textContent=e.name,z.textContent=e.about,O.style.backgroundImage=`url(${e.avatar})`,t.forEach((function(e){C.append(f(e.name,e.link,e.likes,e._id,e.owner._id,0,m,V))}))}));const h=document.forms.new,v=document.querySelector(".popup__input_type_card-name"),S=document.querySelector(".popup__input_type_url"),q=document.querySelector(".profile__image-hover"),b=(document.querySelector(".content"),document.querySelector(".popup_type_add-avatar")),C=(document.querySelector(".popup__input_type_url"),document.querySelector(".places__list")),k=document.querySelector(".popup_type_edit"),g=document.querySelector(".popup_type_new-card"),L=document.querySelector(".profile__edit-button"),E=document.querySelector(".profile__add-button"),j=k.querySelector(".popup__form"),x=j.querySelector(".popup__input_type_name"),w=j.querySelector(".popup__input_type_description"),$=g.querySelector(".popup__form"),P=b.querySelector(".popup__form"),T=document.querySelector(".profile__title"),A=b.querySelector(".popup__input_type_url"),z=document.querySelector(".profile__description"),O=document.querySelector(".profile__image"),B=document.querySelector(".popup_type_image"),D=B.querySelector(".popup__image"),I=B.querySelector(".popup__caption"),M=b.querySelector(".popup__button"),N=g.querySelector(".popup__button"),J=k.querySelector(".popup__button"),H="22e891684787a52df5385b61";function V(e){i(B),D.src=e.target.src,D.alt=e.target.closest(".card").textContent,I.textContent=e.target.closest(".card").textContent}function G(e,t){t.textContent=e?"Сохранение...":"Сохранить"}L.addEventListener("click",(function(e){i(k),x.value=T.textContent,w.value=z.textContent,r(a),c(j,a)})),l(k),l(g),l(B),l(b),E.addEventListener("click",(function(e){i(g),r(a),c($,a)})),q.addEventListener("click",(function(e){i(b),r(a),c(P,a)})),j.addEventListener("submit",(function(e){var t,o;e.preventDefault(),G(!0,J),T.textContent=x.value,z.textContent=w.value,(t=T,o=z,fetch("https://nomoreparties.co/v1/wff-cohort-5/users/me",{method:"PATCH",headers:{authorization:"c52618b5-5707-4e7f-96f5-da48c2905442","Content-Type":"application/json"},body:JSON.stringify({name:`${t.textContent}`,about:`${o.textContent}`})})).then((()=>{s(k)})).finally((()=>{G(!1,J)}))})),h.addEventListener("submit",(function(e){var t,o;e.preventDefault(),G(!0,N),(t=v.value,o=S.value,fetch("https://nomoreparties.co/v1/wff-cohort-5/cards/",{method:"POST",headers:{authorization:"c52618b5-5707-4e7f-96f5-da48c2905442","Content-Type":"application/json"},body:JSON.stringify({name:`${t}`,link:`${o}`})})).then((e=>e.json())).then((e=>{C.prepend(f(e.name,e.link,e.likes,e._id,e.owner._id,0,m,V))})).then((()=>{s(g)})).finally((()=>{G(!1,N)})),h.reset(),c(h,a)})),P.addEventListener("submit",(function(e){var t;e.preventDefault(),G(!0,M),(t=A.value,fetch("https://nomoreparties.co/v1/wff-cohort-5/users/me/avatar",{method:"PATCH",headers:{authorization:"c52618b5-5707-4e7f-96f5-da48c2905442","Content-Type":"application/json"},body:JSON.stringify({avatar:`${t}`})}).then((e=>e.ok?e.json():Promise.reject(`Ошибка: ${e.status}`))).then((e=>{O.style.backgroundImage=`url(${e.avatar})`})).catch((e=>{console.log(e)}))).then((()=>{s(b)})).finally((()=>{G(!1,M)})),O.style.backgroundImage="url(`${avararLinkInput.value}`)",P.reset(),c(P,a)}))})();